openapi: '3.0.0'
info:
  description: EOD Control
  version: '1.0'
  title:  EOD Control Service

tags:
  - name: eod-service-controller
    description: EOD Controller
servers:
  - url: http://ihsmarkit.com

paths:
  /undoCurrentBusinessDay:
    post:
      tags:
        - eod-service-controller
      summary: remove results of the current business day EOD
      operationId: undoCurrentEOD
      parameters:
        - in: query
          name: keepMarketData
          required: true
          schema:
            type: boolean
      responses:
        200:
          description: current business date
          content:
            application/json:
              schema:
                $ref: 'common-types.yaml#/components/schemas/Date'
        401:
          $ref: 'common-types.yaml#/components/responses/Unauthorized'
        403:
          $ref: 'common-types.yaml#/components/responses/Forbidden'
        500:
          $ref: 'common-types.yaml#/components/responses/InternalServerError'
  /undoPreviousBusinessDay:
    post:
      tags:
        - eod-service-controller
      summary: remove results of the current and previous business days EOD and unroll business day
      operationId: undoPreviousEOD
      parameters:
        - in: query
          name: keepMarketData
          required: true
          schema:
            type: boolean
      responses:
        200:
          description: current business date
          content:
            application/json:
              schema:
                $ref: 'common-types.yaml#/components/schemas/Date'
        401:
          $ref: 'common-types.yaml#/components/responses/Unauthorized'
        403:
          $ref: 'common-types.yaml#/components/responses/Forbidden'
        500:
          $ref: 'common-types.yaml#/components/responses/InternalServerError'
  /runEOD1:
    post:
      tags:
        - eod-service-controller
      summary: run EOD1 for the current business day (no business day roll)
      operationId: runEOD1
      responses:
        200:
          description: status
          content:
            text/plain:
              schema:
                type: string
        401:
          $ref: 'common-types.yaml#/components/responses/Unauthorized'
        403:
          $ref: 'common-types.yaml#/components/responses/Forbidden'
        500:
          $ref: 'common-types.yaml#/components/responses/InternalServerError'
  /runEOD2:
    post:
      tags:
        - eod-service-controller
      summary: run EOD2 for the current business day (no business day roll)
      operationId: runEOD2
      responses:
        200:
          description: status
          content:
            text/plain:
              schema:
                type: string
        401:
          $ref: 'common-types.yaml#/components/responses/Unauthorized'
        403:
          $ref: 'common-types.yaml#/components/responses/Forbidden'
        500:
          $ref: 'common-types.yaml#/components/responses/InternalServerError'
  /businessDay:
    get:
      tags:
        - eod-service-controller
      summary: get current business day
      operationId: getCurrentBusinessDay
      responses:
        200:
          description: current business date
          content:
            application/json:
              schema:
                $ref: 'common-types.yaml#/components/schemas/Date'
        401:
          $ref: 'common-types.yaml#/components/responses/Unauthorized'
        403:
          $ref: 'common-types.yaml#/components/responses/Forbidden'
        500:
          $ref: 'common-types.yaml#/components/responses/InternalServerError'
  /rollBusinessDate:
    post:
      tags:
        - eod-service-controller
      summary: roll business day forward
      operationId: rollBusinessDate
      responses:
        200:
          description: current business date
          content:
            application/json:
              schema:
                $ref: 'common-types.yaml#/components/schemas/Date'
        401:
          $ref: 'common-types.yaml#/components/responses/Unauthorized'
        403:
          $ref: 'common-types.yaml#/components/responses/Forbidden'
        500:
          $ref: 'common-types.yaml#/components/responses/InternalServerError'
  /runAll:
    post:
      tags:
        - eod-service-controller
      summary: run EOD1, EOD2 and roll business day forward
      operationId: runAll
      responses:
        200:
          description: current business date
          content:
            application/json:
              schema:
                $ref: 'common-types.yaml#/components/schemas/Date'
        401:
          $ref: 'common-types.yaml#/components/responses/Unauthorized'
        403:
          $ref: 'common-types.yaml#/components/responses/Forbidden'
        500:
          $ref: 'common-types.yaml#/components/responses/InternalServerError'
  /updateCashBallances:
    post:
      tags:
        - eod-service-controller
      summary: update cash balances to reflect total variation margin
      operationId: updateCashBalances
      responses:
        200:
          description: status
          content:
            text/plain:
              schema:
                type: string
        401:
          $ref: 'common-types.yaml#/components/responses/Unauthorized'
        403:
          $ref: 'common-types.yaml#/components/responses/Forbidden'
        500:
          $ref: 'common-types.yaml#/components/responses/InternalServerError'